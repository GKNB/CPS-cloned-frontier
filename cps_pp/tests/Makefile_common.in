# $Id: Makefile_common.in,v 1.10 2004-04-27 18:18:10 cwj Exp $
# @configure_input@
#   This is the makefile for all the commands
#   that are common for all testing applications.
#----------------------------------------------------------------------


SRCDIR = @abs_top_srcdir@
BUILDDIR = @abs_top_builddir@
QOS = @QOS@
COMPILER = @CXX@
LDFLAGS = @LDFLAGS@

BIN = @ARCH@.x



#
# include list for the Columbia code
#
INCLIST = -I${BUILDDIR} -I${SRCDIR}/include @INCLUDE_FLAGS@

CXXFLAGS= @CXXFLAGS@
DFLAGS= @DFLAGS@

CFLAGS = ${CXXFLAGS} ${DFLAGS}

#
# Libraries for the Columbia code
#
# (These are for the scalar version of the code)
#
#

.PHONY: cps clean


LIBLIST =\
  $(BUILDDIR)/cps.a \

#
#  targets
#

me = $(notdir $(PWD))

all:$(BIN)

$(BIN):  main.o
	$(COMPILER) -o $(BIN) main.o $(LIBLIST) $(LDFLAGS)

main.o: main.C
	$(COMPILER) -o main.o $(CFLAGS) -c $(INCLIST) main.C

cps:
	$(MAKE) -C $(BUILDDIR)

clean:
	rm -f *.dat *.o  $(BIN)
	rm -f ../regressions/*$(me).dat
	rm -f ../regressions/*$(me).checklog

